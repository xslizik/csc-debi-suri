---
- name: Update packages
  apt:
    update_cache: yes

- name: Install required packages
  apt:
    name: "{{ item }}"
    state: present
  loop:
    - software-properties-common
    - jq
    - wget
    - gnupg
    - apt-transport-https
    - unzip
    - libpcre2-dev
    - libyaml-dev
    - libjansson-dev
    - libpcap-dev
    - gawk
    - libunwind-dev
    - libmagic-dev
    - liblz4-dev
    - libcap-ng-dev

- name: Download Suricata source
  get_url:
    url: https://www.openinfosecfoundation.org/download/suricata-7.0.1.tar.gz
    dest: /home/vagrant/suricata-7.0.1.tar.gz

- name: Extract Suricata source
  unarchive:
    src: /home/vagrant/suricata-7.0.1.tar.gz
    dest: /home/vagrant/
    remote_src: yes

- name: Remove Suricata source
  file:
    path: /home/vagrant/suricata-7.0.1.tar.gz
    state: absent