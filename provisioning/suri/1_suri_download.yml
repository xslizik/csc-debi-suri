- name: Create suricata group
  group:
    name: suricata
    state: present

- name: Add vagrant to suricata group
  user:
    name: vagrant
    groups: suricata
    append: yes
    
- name: Copy files to /home/vagrant
  copy:
    src: transfer/scripts/{{ item }}
    dest: /home/vagrant
    mode: "0770"
    group: "suricata"
  with_items:
    - pcap_suri.sh
    - interface_suri.sh
    - setup.sh
    
- name: Run Suricata setup.sh
  command:
    cmd: "/home/vagrant/setup.sh"

- name: Remove suricata setup.sh
  file:
    path: /home/vagrant/setup.sh
    state: absent

- name: Update Suricata rules
  shell: suricata-update update-sources -D /etc/suricata
  register: update_result